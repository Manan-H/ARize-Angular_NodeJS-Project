"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const testing_1 = require("@angular-devkit/schematics/testing");
const testing_2 = require("@ng-toolkit/_utils/testing");
// import { Tree } from '@angular-devkit/schematics';
const collectionPath = path.join(__dirname, './collection.json');
describe('Serverless', () => {
    let appTree;
    const schematicRunner = new testing_1.SchematicTestRunner('@ng-toolkit/serverless', collectionPath);
    const defaultOptions = {
        clientProject: 'foo',
        disableBugsnag: true
    };
    beforeEach((done) => {
        appTree = schematicRunner.runExternalSchematic('@schematics/angular', 'workspace', {
            name: 'workspace',
            version: '6.0.0',
            newProjectRoot: 'projects'
        });
        schematicRunner.runExternalSchematic('@schematics/angular', 'application', { name: 'foo' }, appTree);
        schematicRunner.runExternalSchematicAsync('@ng-toolkit/universal', 'ng-add', defaultOptions, appTree).subscribe(tree => {
            appTree = tree;
            done();
        });
    });
    xit('Should create files', (done) => {
        schematicRunner.runSchematicAsync('ng-add', defaultOptions, appTree).subscribe(tree => {
            testing_2.checkIfFileExists(tree, `/local.js`);
            testing_2.checkIfFileExists(tree, `/server.ts`);
            testing_2.checkIfFileExists(tree, `/projects/foo/src/app/app.browser.module.ts`);
            testing_2.checkIfFileExists(tree, `/projects/foo/src/app/app.server.module.ts`);
            testing_2.checkIfFileExists(tree, `/projects/foo/src/main.server.ts`);
            testing_2.checkIfFileExists(tree, `/projects/foo/src/tsconfig.server.json`);
            testing_2.checkIfFileExists(tree, `/projects/foo/webpack.server.config.js`);
            testing_2.checkIfFileExists(tree, `/ng-toolkit.json`);
            done();
        });
    });
    // it('Should throw exception if @angular/pwa not runned', (done) => {
    //     schematicRunner.runSchematicAsync('ng-add', defaultOptions, appTree).subscribe(tree => {
    //         const cliConfig = JSON.parse(getFileContent(tree, `${defaultOptions.directory}/angular.json`));
    //         console.log(cliConfig);
    //         done();
    //     });
    // });
});
//# sourceMappingURL=schematics_spec.js.map